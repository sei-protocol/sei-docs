
import { Callout } from "nextra/components";
import { ImageWithCaption } from "../../components";
import PointerContractsWithout from "../../public/assets/pointer-contracts-without.png";
import PointerContractsSimplified from "../../public/assets/pointer-contracts-simplified.png";
import HowItWorks from "../../public/assets/pointer-contracts-how-it-works.png";
import addressTranslationImage from "../../public/assets/address-derivation.png";

# Pointer Contracts

Pointer Contracts enable tokens to be used interoperably in both EVM and CosmWasm environments.

## Why Pointer Contracts

<ImageWithCaption img={PointerContractsWithout} alt="Without Pointer Contracts" caption="A world without pointer contracts"/>
Wallets and clients for feature-rich protocols typically support only a single execution environment.
EVM wallets handle ERC-20 coins and ERC-721 NFTs but can't interact with CW-based contracts because they use different token standards and contract interaction methods.

Likewise, CosmWasm-intended clients can't directly interact with Ethereum-based ERC tokens or contracts.

Pointer Contracts solve this by allowing tokens from one environment to be used in the other.
<ImageWithCaption img={PointerContractsSimplified} alt="With Pointer Contracts" caption="With pointer contracts, all tokens can be accessed by wallets of either environment"/>

Each token contract can have only **one* linked pointer contract, enabling CW-20/CW-721 tokens to be treated as ERC-20/ERC-721 tokens by the EVM, and vice versa.

The pointer contract registry was created to improve security and clarity for users. By registering pointer contracts, tokens are accurately mapped and recognized across different environments. This prevents conflicts and ensures users can verify the authenticity of contracts, promoting a more secure and user-friendly ecosystem.

## How it Works
A pointer contract serves as a wrapper around its corresponding contract in the other environment.
<ImageWithCaption img={HowItWorks} alt="How it works" caption="EVM Pointer contracts for CW-20 tokens and Native tokens"/>

Pointer contracts forward messages to their paired contract without storing their own state or creating any token. The destination contract or bank module remains the sole source of truth for token data. This allows all wallet types to interact seamlessly with any contract or token without added risk or complicated front-end workarounds.

When an EVM pointer contract is called, it:
- Translates the message to an equivalent message understood by the underlying CosmWasm contract/module.
- Forwards the message to the correct destination.

## Deploying a Pointer Contract

This section guides you through the process of deploying a Pointer Contract for various token standards using the seid CLI tool.

<Callout type="info">
  For an in-depth understanding of Sei token standards, click
  [here](/token-standards).
</Callout>

### Prerequisites

To deploy a Pointer Contract on devnet, you'll need the following:

- Sei light client (CLI/daemon) installed on your machine. If not, you can install it by following the [installation guide](/quickstart/installing-seid.mdx).
- Have your CW20 or ERC20 token details, as you'll need them to create the corresponding pointer token.

Before deploying a pointer, you should first check if a pointer for the token/contract you wish to deploy already exists by running the following query:

```bash
seid q evm pointer $TYPE $POINTEE --evm-rpc=https://evm-rpc.arctic-1.seinetwork.io/
```

**Arguments**

- `TYPE`: One of "ERC20", "ERC721", "NATIVE", "CW20", and "CW721". Note that type refers to the underlying token type, so a type of "ERC20" refers to a CosmWasm pointer pointing to an ERC-20 token.
- `POINTEE`: the underlying token denom literal in the case of "NATIVE" type, or the underlying token contract address for all other types

**Flags**

- `--evm-rpc`: The endpoint URL for the EVM RPC interface of the Sei blockchain. This URL is used by the `seid` command to interact with the Sei EVM.

### Deploying an EVM Pointer Contract

To deploy an EVM Pointer Contract that links to a CosmWasm contract, you can use the following command:

```bash
seid tx evm register-evm-pointer [pointer type] [cw-address] --gas-fee-cap=<cap> --gas-limit=<limit> --evm-rpc=<url>
```

**Arguments**

- `pointer type`: The type of pointer you want to create, either CW20, CW721, or NATIVE.
- `cw-address`: The address of the CosmWasm contract you want to create an EVM pointer for.

**Flags**

- `--gas-fee-cap`: The maximum amount of gas fees that can be charged for the transaction.
- `--gas-limit`: The maximum amount of gas that can be consumed by the transaction.
- `--evm-rpc`: The endpoint URL for the EVM RPC interface of the Sei blockchain. This URL is used by the `seid` command to interact with the Sei EVM.

<Callout type="info">
  To learn more about the various command line arguments and flags, use the
  `--help` flag for any CLI commands. For example:

    ```bash copy
    seid tx evm --help
    ```
</Callout>

### Deploying a CW Pointer Contract

#### For ERC20 Tokens

To deploy a CW20 Pointer Contract that links to an ERC20 token, you can use the following command:

```bash
seid tx evm register-cw-pointer ERC20 $ERC20_TOKEN_ADDRESS --from=$SENDER --chain-id=arctic-1 --broadcast-mode=block --gas=250000 --fees=25000usei --node=https://rpc-arctic-1.sei-apis.com/
```

**Arguments**

- `ERC20_TOKEN_ADDRESS`: The contract address of the ERC20 token you want to create a CW20 pointer for.

**Flags**

- `--from`: Keyfile (by name) from which the tx is sent. This address must have enough balance to cover transaction fees.
- `--chain-id`: Identifies the specific chain of the Sei network you're interacting with. `arctic-1` refers to the Sei devnet.
- `--broadcast-mode`: Determines how the transaction is broadcasted. Setting this to `block` means the transaction will wait to be included in a block before returning a response.
- `--gas`: Specifies the maximum amount of gas that can be consumed by the transaction.
- `--fees`: Indicates the transaction fee.
- `--node`: Points to the specific Sei node RPC URL you're connecting to for transaction submission.

<Callout type="info">
  To check out the source code,
  please visit our [GitHub
  page](https://github.com/sei-protocol/sei-chain/tree/evm/example/cosmwasm/cw20).
</Callout>

#### For ERC721 Tokens

To deploy a CW721 Pointer Contract that links to an ERC721 token, you can use the following command:

```bash
seid tx evm register-cw-pointer ERC20 $ERC721_TOKEN_ADDRESS --from=$SENDER --chain-id=arctic-1 --broadcast-mode=block --gas=250000 --fees=25000usei --node=https://rpc-arctic-1.sei-apis.com/
```

**Arguments**

- `ERC721_TOKEN_ADDRESS`: The contract address of the ERC721 token you want to create a CW721 pointer for.

**Flags**

- `--from`: Keyfile (by name) from which the tx is sent. This address must have enough balance to cover transaction fees.
- `--chain-id`: Identifies the specific chain of the Sei network you're interacting with. `arctic-1` refers to the Sei devnet.
- `--broadcast-mode`: Determines how the transaction is broadcasted. Setting this to `block` means the transaction will wait to be included in a block before returning a response.
- `--gas`: Specifies the maximum amount of gas that can be consumed by the transaction.
- `--fees`: Indicates the transaction fee.
- `--node`: Points to the specific Sei node RPC URL you're connecting to for transaction submission.

<Callout type="info">
  To check out the source code,
  please visit our [GitHub
  page](https://github.com/sei-protocol/sei-chain/tree/evm/example/cosmwasm/cw721).
</Callout>
