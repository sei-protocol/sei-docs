---
title: 'Consensus Deep Dive'
description: 'Operator-oriented reference for Sei consensus, mempool, and vote extension status.'
keywords: ['consensus', 'mempool', 'vote extensions', 'sei tendermint']
---

import { Callout } from 'nextra/components';
import { CardGrid, KeyValueTable, TroubleshootingTable } from '../../mdx-components';

# Consensus Deep Dive

Sei uses a Tendermint-based consensus engine tuned for high-throughput EVM workloads. This guide summarises the latest behavioural changes so validator operators and infrastructure teams can keep nodes healthy.

<Callout type="info">Covers `sei-tendermint@02c9462f1` (duplicate transaction cache sizing) and the current vote-extension posture.</Callout>

## Key Concepts

<KeyValueTable
  rows={[
    ['Consensus Algorithm', 'Tendermint BFT with instant finality and 2/3 voting power requirement.'],
    ['Block Time Target', '~1s.'],
    ['Mempool Mode', 'Parallel check with duplicate transaction cache (LRU) sized via `mempool.cache_size`.'],
    ['Vote Extensions', 'Disabled on mainnet. Enabling is irreversible (see below).']
  ]}
/>

<Callout type="info">`sei-tendermint@02c9462f1` corrected duplicate transaction cache accounting, and the public networks continue to run with vote extensions disabled.</Callout>

## Duplicate Transaction Cache

<KeyValueTable
  rows={[
    ['Patch reference', '`sei-tendermint@02c9462f1` enforces the configured cache ceiling and clears entries on inclusion/removal.'],
    ['`mempool.cache_size` baseline', 'Default `10000`. Scale to `20000` for high-throughput validators but monitor RSS to avoid memory pressure.'],
    ['Cache behaviour', 'Entries now evict predictably; large keys no longer overflow. RPC eviction mirrors block inclusion.'],
    ['Monitoring', 'Track `mempool_cache_size` and alert when utilisation > 90% for > 2 minutes.']
  ]}
/>

## Vote Extensions

<KeyValueTable
  rows={[
    ['Network status', 'Disabled on Sei mainnet/testnet. No vote payloads expected.'],
    ['Irreversibility', '`types/params.go` enforces "vote extensions cannot be disabled once enabled". Treat the flag as one-way.'],
    ['Operator guidance', 'Do not toggle experimental configs without explicit release instructions; enabling requires coordinated rollout and client changes.']
  ]}
/>

## Operational Best Practices

<CardGrid
  items={[
    {
      title: 'Recheck discipline',
      description: 'Leave `mempool.recheck` = false in production. Toggle briefly only after app upgrades to purge invalid txs.',
      href: '/node/technical-reference#consensus'
    },
    {
      title: 'Metric coverage',
      description: 'Alert on `consensus_height` stalls and `mempool_cache_size` plateaus; pair with duplicate-tx warnings in logs.',
      href: '/node/troubleshooting'
    },
    {
      title: 'Recovery playbook',
      description: 'Use snapshots/state sync first. `seid unsafe-reset-all` should be last resort with refreshed peer sets.',
      href: '/node/node-incident-playbooks'
    }
  ]}
/>

## Troubleshooting

<TroubleshootingTable
  rows={[
    ['Duplicate tx errors after upgrade', 'Cache size too small for current traffic.', 'Increase `mempool.cache_size` in `config.toml` and restart the node.'],
    ['Unexpected vote extension logs', 'Experimental configuration toggled vote extensions.', 'Revert the change; once enabled the protocol expects extension payloads from validators.'],
    ['Consensus halt around upgrade height', 'Nodes running mixed binaries or stale state.', 'Ensure all validators run the same release, apply the same config, and coordinate a state-sync fallback.'],
    ['Height stuck with high round numbers', 'Proposer starvation or peers throttled.', 'Check `consensus_round` metric, rebalance peer set, and ensure fast proposers have adequate upstream bandwidth.'],
    ['Block time drifts >1s', 'Timeout overrides reverted to defaults or hardware saturated.', 'Audit `timeout_commit`/`timeout_propose` values and host load; reapply Sei defaults and scale hardware if needed.']
  ]}
/>

## Pipeline Overview

<KeyValueTable
  rows={[
    ['Height preparation', 'Before height `H` starts, validators prefetch writesets via `GenerateEstimatedWritesets` and warm SeiDB caches (see `app/abci/prepare`).'],
    ['Proposal creation', '`CreateProposalBlock` builds blocks with OCC metadata; duplicate-tx cache ensures replays are skipped.'],
    ['Parallel execution', '`DeliverTxBatch` dispatches to the parallel executor while `EnterPrevote` / `EnterPrecommit` continue in Tendermint.'],
    ['Commit handoff', '`Commit` applies buffered state via SeiDB snapshots; Tendermint then immediately schedules height `H+1` with cached proposal data.'],
    ['EVM pipeline touchpoints', '`evmrpc` surfaces the newly committed block; ensure downstream indexers handle ~400 ms cadence.']
  ]}
/>

## Configuration Reference

<KeyValueTable
  rows={[
    ['`consensus.timeout_commit`', '`config/config.toml` → keep near `400ms` to match target latency; raising increases block time.'],
    ['`consensus.timeout_propose` / `timeout_propose_delta`', 'Shortened in Sei defaults—ensure overrides persist when regenerating configs.'],
    ['`consensus.create_empty_blocks_interval`', 'Typically `0s` so empty blocks maintain heartbeat; adjust only for isolated private nets.'],
    ['`mempool.cache_size`', '`config/config.toml` → default `10000`, scale gradually with RAM; tied to duplicate-tx cache behaviour.'],
    ['`p2p.send_rate` / `recv_rate`', 'Raised to handle parallelized gossip; reverting to Tendermint defaults can throttle consensus packets.']
  ]}
/>

## Telemetry & SLOs

<KeyValueTable
  rows={[
    ['Block latency', '`consensus_block_interval_seconds` p95 ≤ 0.45 s. Alert if >0.6 s for 5 minutes.'],
    ['Round health', '`consensus_round` should oscillate between 0–2; sustained >3 indicates proposal issues.'],
    ['Duplicate cache utilisation', '`seimempool_cache_used` / `seimempool_cache_capacity` < 0.9 outside bursts.'],
    ['Peer availability', '`p2p_peer_count` ≥ expected sentries; drops correlate with proposer timeouts.'],
    ['EVM finality', 'Cross-check `eth_blockNumber` vs `seid status` height; drift >1 block signals RPC lag.']
  ]}
/>

## Upgrade Validation Checklist

<KeyValueTable
  rows={[
    ['Consensus state', '`seid debug consensus-state` → rounds progress and proposer rotates.'],
    ['Block cadence', 'Monitor `seid status | jq .SyncInfo.latest_block_time` across 20 blocks—intervals cluster around 400 ms.'],
    ['Cache enforcement', 'Run `seid debug mempool-stats`; cache size equals configured limit post-upgrade.'],
    ['RPC parity', '`eth_getBlockByNumber` matches Tendermint height; duplicate receipts absent.'],
    ['Telemetry sanity', 'Grafana/Prom scale dashboards show latency/round metrics within SLO bands before declaring upgrade complete.']
  ]}
/>

## Related Material

<CardGrid
  items={[
    {
      title: 'Technical Reference',
      description: 'Full node configuration matrix including `config.toml` consensus knobs.',
      href: '/node/technical-reference'
    },
    {
      title: 'Incident Playbooks',
      description: 'Response drills for consensus halts, snapshot issues, and P2P partitions.',
      href: '/node/node-incident-playbooks'
    },
    {
      title: 'RPC Gas Accounting',
      description: 'How block-level gas totals interact with consensus updates post-`v6.1.11`.',
      href: '/evm/rpc-gas-accounting'
    },
    {
      title: 'Twin Turbo Consensus',
      description: 'Protocol-level explainer of Sei’s pipelined Tendermint flow for sub-second finality.',
      href: '/learn/twin-turbo-consensus'
    }
  ]}
/>

<Callout type="info">
  Looking for the protocol architecture view? Read <a href="/learn/twin-turbo-consensus">Twin Turbo Consensus</a>. That explainer now links back here for operator-specific configuration notes.
</Callout>
